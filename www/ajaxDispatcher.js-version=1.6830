(function(d){var f={put:function(h,g){(g||window).location.hash=this.encoder(h)},get:function(i){var h=((i||window).location.hash).replace(/^#/,"");try{return d.browser.mozilla?h:decodeURIComponent(h)}catch(g){return h}},encoder:encodeURIComponent};var c={id:"__jQuery_history",init:function(){var g='<iframe id="'+this.id+'" style="display:none" src="javascript:false;" />';d("body").prepend(g);return this},_document:function(){return d("#"+this.id)[0].contentWindow.document},put:function(h){var g=this._document();g.open();g.close();f.put(h,g)},get:function(){return f.get(this._document())}};function e(h){h=d.extend({unescape:false},h||{});f.encoder=i(h.unescape);function i(j){if(j===true){return function(k){return k}}if(typeof j=="string"&&(j=g(j.split("")))||typeof j=="function"){return function(k){return j(encodeURIComponent(k))}}return encodeURIComponent}function g(k){var j=new RegExp(d.map(k,encodeURIComponent).join("|"),"ig");return function(l){return l.replace(j,decodeURIComponent)}}}var b={};b.base={callback:undefined,type:undefined,check:function(){},load:function(g){},init:function(h,g){e(g);a.callback=h;a._options=g;a._init()},_init:function(){},_options:{}};b.timer={_appState:undefined,_init:function(){var g=f.get();a._appState=g;a.callback(g);setInterval(a.check,100)},check:function(){var g=f.get();if(g!=a._appState){a._appState=g;a.callback(g)}},load:function(g){if(g!=a._appState){f.put(g);a._appState=g;a.callback(g)}}};b.iframeTimer={_appState:undefined,_init:function(){var g=f.get();a._appState=g;c.init().put(g);a.callback(g);setInterval(a.check,100)},check:function(){var h=c.get(),g=f.get();if(g!=h){if(g==a._appState){a._appState=h;f.put(h);a.callback(h)}else{a._appState=g;c.put(g);a.callback(g)}}},load:function(g){if(g!=a._appState){f.put(g);c.put(g);a._appState=g;a.callback(g)}}};b.hashchangeEvent={_init:function(){a.callback(f.get());d(window).bind("hashchange",a.check)},check:function(){a.callback(f.get())},load:function(g){f.put(g)}};var a=d.extend({},b.base);if(d.browser.msie&&(d.browser.version<8||document.documentMode<8)){a.type="iframeTimer"}else{if("onhashchange" in window){a.type="hashchangeEvent"}else{a.type="timer"}}d.extend(a,b[a.type]);d.history=a})(jQuery);var ajaxDispatcher={};ajaxDispatcher.onAfterDispatch=undefined;$(document).ready(function(){$.history.init(ajaxDispatcher.dispatchOnPageLoad)});ajaxDispatcher.execute=function(b){var a=true;if($(b).hasClass("notUserAjaxDefaultDispatch")){a=false}var c=$(b).attr("ajaxHistory");c=c.replace(/^.*#/,"");$.history.load(c,a);return false};ajaxDispatcher.dispatchOnPageLoad=function(a){ajaxDispatcher.dispatchForum(a);ajaxDispatcher.dispatchBlog(a);ajaxDispatcher.dispatchGallery(a)};ajaxDispatcher.dispatchGallery=function(h){var g=new Array();if(h.indexOf("dispatchGallery")!=-1){var f=h.match(/.*dispatchGallery(\d+)=/);var c=h.match(/.*dispatchGallery\d+=([^\/]*)/);var e=h.match(/widgetId=([^\/]*)/);var b=h.match(/siteShowOption=([^\/]*)/);var a=h.match(/filledFormId=([^\/]*)/);var d={galleryId:f[1],galleryDispatchType:c[1],widgetId:e[1],filledFormId:a!=null?a[1]:0,siteShowOption:b[1]};g.push(d.widgetId);new ServiceCall().executeViaDwr("GalleryDispatchService","executeDispatch",d,function(i){showGalleryData(d.galleryId,d.filledFormId,d.widgetId,d.siteShowOption,null,i);if($("#widget"+d.widgetId).length>0){$("#widget"+d.widgetId)[0].widgetDispatched=true}if(ajaxDispatcher.onAfterDispatch){ajaxDispatcher.onAfterDispatch();ajaxDispatcher.onAfterDispatch=undefined}})}$("div.widgetGALLERYStyle").each(function(){var j=$(this).attr("widgetId");if(this.widgetDispatched&&!contains(g,j)){var i={galleryId:$(this).find("#galleryId"+j).val(),galleryDispatchType:"SHOW_GALLERY",widgetId:j,filledFormId:$(this).find("#firstFilledFormId"+j).val(),siteShowOption:$(this).find("#siteShowOption"+j).val()};if(i.filledFormId!="null"){new ServiceCall().executeViaDwr("GalleryDispatchService","executeDispatch",i,function(k){showGalleryData(i.galleryId,i.filledFormId,i.widgetId,i.siteShowOption,null,k);$("#widget"+j)[0].widgetDispatched=false})}}})};ajaxDispatcher.dispatchBlog=function(f){var c=new Array();if(f.indexOf("dispatchBlog")!=-1){var e=f.match(/.*dispatchBlog(\d+)=/);var h=f.match(/.*dispatchBlog\d+=([^\/]*)/);var g=f.match(/widgetId=([^\/]*)/);var b=f.match(/siteShowOption=([^\/]*)/);var i=f.match(/startIndex=([^\/]*)/);var a=f.match(/exactBlogPostId=([^\/]*)/);var d={blogId:e[1],dispatchBlog:h[1],widgetId:g[1],startIndex:i!=null?i[1]:0,exactBlogPostId:a!=null?a[1]:null,siteShowOption:b[1]};c.push(d.widgetId);new ServiceCall().executeViaDwr("BlogDispatchService","executeDispatch",d,function(j){$("#widget"+d.widgetId).html(j);$("#widget"+d.widgetId)[0].widgetDispatched=true;if(ajaxDispatcher.onAfterDispatch){ajaxDispatcher.onAfterDispatch();ajaxDispatcher.onAfterDispatch=undefined}})}$("div.widgetBLOGStyle").each(function(){var k=$(this).attr("widgetId");if(this.widgetDispatched&&!contains(c,k)){var j={blogId:$(this).find("#blogId"+k).val(),dispatchBlog:"SHOW_BLOG",widgetId:k,siteShowOption:$(this).find("#siteShowOption"+k).val()};new ServiceCall().executeViaDwr("BlogDispatchService","executeDispatch",j,function(l){$("#widget"+k).html(l);$("#widget"+k)[0].widgetDispatched=false})}})};ajaxDispatcher.dispatchForum=function(f){var b=new Array();if(f.indexOf("dispatchForum")!=-1){var i=f.match(/.*dispatchForum(\d+)=/);var c=f.match(/.*dispatchForum\d+=([^\/]*)/);var h=f.match(/subForumId=([^\/]*)/);var e=f.match(/threadId=([^\/]*)/);var g=f.match(/widgetId=([^\/]*)/);var a=f.match(/showOnUserPages=([^\/]*)/);var d={dispatchForum:c[1],widgetId:g[1],showOnUserPages:a[1],forumId:i!=null?i[1]:null,subForumId:h!=null?h[1]:null,threadId:e!=null?e[1]:null};b.push(d.widgetId);new ServiceCall().executeViaDwr("ForumDispatchService","executeDispatch",d,function(j){$("#widget"+d.widgetId).html(j);$("#widget"+d.widgetId)[0].widgetDispatched=true;if(ajaxDispatcher.onAfterDispatch){ajaxDispatcher.onAfterDispatch();ajaxDispatcher.onAfterDispatch=undefined}})}$("div.widgetFORUMStyle").each(function(){var k=$(this).attr("widgetId");if(this.widgetDispatched&&!contains(b,k)){var j={forumId:$(this).find("#forumId"+k).val(),dispatchForum:"SHOW_FORUM",widgetId:k,showOnUserPages:$(this).find("#showOnUserPages"+k).val()};new ServiceCall().executeViaDwr("ForumDispatchService","executeDispatch",j,function(l){$("#widget"+k).html(l);$("#widget"+k)[0].widgetDispatched=false})}})};